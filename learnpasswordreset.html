<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Reset Your Password</title>
  <!-- your CSSâ€¦ -->
</head>
<body>
  <h1>ðŸ”‘ Reset Your Password</h1>
  <input id="pwd"         type="password" placeholder="New password"/>
  <input id="pwd-confirm" type="password" placeholder="Confirm password"/>
  <button id="reset-btn">Reset Password</button>

  <script>
  // 2) Grab createClient from the global:
  const { createClient } = supabase

  // 3) Initialize with your URL + anon key and autoâ€consume the #access_token fragment
  const client = createClient(
    'https://geznczcokbgybsseipjg.supabase.co',
    'YOUR-ANON-KEY',
    { auth: { detectSessionInUrl: true } }
  )

  // 4) Wire up your button exactly as before:
  const btn = document.getElementById('reset-btn')
  const pwd = document.getElementById('pwd')
  const confirm = document.getElementById('pwd-confirm')

  // Debug: check the session
  client.auth.getSession().then(({ data:{session}, error }) => 
    console.debug('Session on load:', session, error)
  )

  btn.addEventListener('click', async () => {
    if (!pwd.value || pwd.value !== confirm.value) {
      return alert('Passwords must match!')
    }
    const { data:{session}, error: sessErr } = await client.auth.getSession()
    if (sessErr || !session) {
      return alert('No recovery sessionâ€”use the email link.')
    }
    const { error } = await client.auth.updateUser({ password: pwd.value })
    if (error) alert('Error: '+error.message)
    else {
      alert('Password updated!')
      window.location.href = '/login'
    }
  })
</script>
</body>
</html>
